<html>
<head>
<script src="lib/abcjs_editor_1.0.12-min.js" type="text/javascript"></script>
<script src="lib/jq.js" type="text/javascript"></script>
<script src="lib/fd.js" type="text/javascript"></script>
<script src="lib/DomainHelper.js" type="text/javascript"></script>

<script src="lib/Note.js" type="text/javascript"></script>
<script src="lib/Interval.js" type="text/javascript"></script>
<script>
var S = new FD.space();
S.decl('X', [[1,2]] );
S.decl('Y', [[3,5]] );

S.num('three', 5);
S.neq( S.wsum([1,1], ['X','Y']), 'three');
S.newprop = function() {}
S.newprop( {
	depvars: ['Y'],
	allvars: ['X','Y'],
	step: function() {
		try{
		var x = this.space[1], y=this.space[2];
		var nextStep = x.step + y.step;
		if (nextStep > this.last_step) {
			var xl = DomainHelper.domain_to_list( x.dom ), yl = DomainHelper.domain_to_list(y.dom);
			// prevent x+y=3
			var valid = [];
			for (var i=0;i<xl.length;++i) {
				var cnt = 0;
				for (var j=0;j<yl.length;++j) {
					if (xl[i] + yl[j] === 5) {
						++cnt;
					} else {
						break;
					}
				}
				if (cnt < yl.length) { // if it's equal, X plus all of y will be invalid and shld be removed
					valid.push(xl[i]);
				}
			}
			
			x.set_dom(
				DomainHelper.domain_non_empty(
					DomainHelper.list_to_domain(valid)
				));
		} else { return 0; }
		}catch(e) {
			alert(e);
		}
		return this.last_step - nextStep;
	}
});
S.newprop( {
	depvars: ['Y'],
	allvars: ['X','Y'],
	step: function() {
		try{
		var x = this.space[2], y=this.space[1];
		var nextStep = x.step + y.step;
		if (nextStep > this.last_step) {
			var xl = DomainHelper.domain_to_list( x.dom ), yl = DomainHelper.domain_to_list(y.dom);
			// prevent x+y=3
			var valid = [];
			for (var i=0;i<xl.length;++i) {
				var cnt = 0;
				for (var j=0;j<yl.length;++j) {
					if (xl[i] + yl[j] === 5) {
						++cnt;
					} else {
						break;
					}
				}
				if (cnt < yl.length) { // if it's equal, X plus all of y will be invalid and shld be removed
					valid.push(xl[i]);
				}
			}
			
			x.set_dom(
				DomainHelper.domain_non_empty(
					DomainHelper.list_to_domain(valid)
				));
		}
		}catch(e) {
			alert(e);
		}
		return this.last_step - nextStep;
	}
});

FD.distribute.fail_first(S, ['X','Y']);

var state = {space: S};
do {
	FD.search.depth_first(state);
	if (state.status === 'solved') {
		var S = state.best || state.space;
		document.write(JSON.stringify(S.solution()));
	}
}while(state.more);

</script>
<style>
html, body, div, span, object, iframe,h1, h2, h3, h4, h5, h6, p, blockquote, pre,a, abbr, acronym, address, big, cite, 
code,del, dfn, em, img, ins, kbd, q, samp,small, strike, strong, sub, sup, tt, var,b, i, dl, dt, dd, ol, ul, li,fieldset, 
form, label, legend,table, caption, tbody, tfoot, thead, tr, th, td  {margin: 0;padding: 0;border: 0;font-size: 100%;vertical-align: baseline;background: transparent; }
address, cite, q, dfn {font-style: normal;}
h1, h2, h3, h4, h5, h6, th {font-weight: normal;}
a, ins, del {text-decoration: none;color: black;}
q, blockquote {quotes: none;}
q:after, q:before,blockquote:after, blockquote:before {content: "";content: none;}
table {border-collapse: collapse;border-spacing: 0;}
th, td {vertical-align: top;}
th {text-align: left;}
button, input, select, textarea {font: inherit;text-align:justify;}
ul {list-style-type: none;}
.clearer {clear: both; height: 0px;}
hr { border: 1px solid black; border-width: 1px 0 0 0;}
.hide {display: none;}
.fh { height: 100%; }
#solns .soln {
	padding: 0 0 20px 20px;
	background: #ffc;
	border-radius: 10px;
	margin: 10px;
}
#solns .soln a { color: #933; text-decoration: underline;}
</style>
</head>
<body>

<div id="button-div">
	<!--textarea id="input" style="width: 600px; height: 60px;font-family: consolas">D|F|E|D|G|F|A|G|F|E|D</textarea><br /-->
	<textarea id="input" style="width: 600px; height: 60px;font-family: consolas">C|C|G|G|A|A|G|F|F|E|E|D|D|C</textarea><br />
	<input type="button" value="Solve" id="solve-button" />
</div>
<div id="solns">
</div>

</body>
</html>